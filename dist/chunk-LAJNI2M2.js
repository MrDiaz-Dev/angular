import{a as de,b as ce}from"./chunk-S4X2VTSF.js";import{a as ue}from"./chunk-6X2M4KTX.js";import{a as pe}from"./chunk-F3M6RHPZ.js";import{a as le}from"./chunk-EZQMAT3F.js";import"./chunk-FZ42FID5.js";import{a as re}from"./chunk-YM5FUEHW.js";import{a as B}from"./chunk-224O6KQT.js";import{a as V}from"./chunk-DYKERIVD.js";import{a as se}from"./chunk-N25QT2AP.js";import{C as ie,E as oe,N as ne,S as ae,U as k,s as E}from"./chunk-KMAW7RSO.js";import"./chunk-2A4Z2JYH.js";import{n as Y,z as Z}from"./chunk-SR3JLMZB.js";import{A as $,D as ee,E as te,k as K,q as Q,y as X}from"./chunk-ZGX2TZUZ.js";import{Hb as p,Ib as J,Jb as L,K as O,Lb as w,Mb as b,Nb as T,O as q,Oa as l,Pb as R,Qb as f,U as c,Y as M,Z as D,Za as g,_a as G,eb as x,ga as z,gb as u,ia as m,ja as _,jb as y,lb as h,pa as F,qa as W,qb as r,rb as a,sb as C,sc as P,tc as j,v as U,wb as v,xb as N,yb as s,z as A}from"./chunk-FFU3QAVA.js";import"./chunk-CWTPBX7D.js";function H(i,d){let e=!d?.manualCleanup;e&&!d?.injector&&z(H);let o=e?d?.injector?.get(F)??c(F):null,t;d?.requireSync?t=g({kind:0}):t=g({kind:1,value:d?.initialValue});let n=i.subscribe({next:S=>t.set({kind:1,value:S}),error:S=>{if(d?.rejectErrors)throw S;t.set({kind:2,error:S})}});return o?.onDestroy(n.unsubscribe.bind(n)),P(()=>{let S=t();switch(S.kind){case 1:return S.value;case 2:throw S.error;case 0:throw new O(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}var he=()=>({width:"100%",maxWidth:"270px",aspectRatio:"1",borderRadius:"10%",objectFit:"cover",boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.2)"}),I=()=>({width:"-webkit-fill-available"}),_e=(()=>{class i{constructor(){this.fechaService=c(B),this.datosPersonales=G(),this.datosComunesIdTipo=W(),this.bajaMedicaActual=W(),this.tituloSituacionLaboralActualPMessage=P(()=>[{severity:"info",summary:`${this.datosComunesIdTipo().idCategoria.nombre}`,detail:this.datosComunesIdTipo().nombre==this.datosComunesIdTipo().idCategoria.nombre?"":this.datosComunesIdTipo().nombre,icon:"pi pi-briefcase"}]),this.bajaMedicaActualPMessage=P(()=>this.bajaMedicaActual()?[{severity:"error",summary:"Baja m\xE9dica activa:",detail:`Desde ${this.fechaService.formatFecha(this.bajaMedicaActual())}`,icon:"pi pi-exclamation-circle"}]:[])}cargarFotografiaURL(){return this.datosPersonales()?.fotografia?V.STORAGE_URL+this.datosPersonales()?.fotografia:"assets/images/notImage.png"}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-cabecera-datos-personales"]],inputs:{datosPersonales:[M.SignalBased,"datosPersonales"],datosComunesIdTipo:[M.SignalBased,"datosComunesIdTipo"],bajaMedicaActual:[M.SignalBased,"bajaMedicaActual"]},outputs:{datosPersonales:"datosPersonalesChange"},standalone:!0,features:[R],decls:40,vars:29,consts:[[1,"grid"],[1,"col-12","grid","pb-0",2,"width","-webkit-fill-available"],[1,"col-12","md:col-4","xl:col-3","pb-0","flex","align-items-center","justify-content-center"],[1,"flex","flex-column","justify-content-center","mx-4",2,"min-height","230px","min-width","190px"],["alt","avatar","showTransitionOptions","0ms","loading","lazy",1,"rounded","float-right","img-thumbnail","img-fluid",3,"src","imageStyle","preview","pTooltip"],[1,"col-12","md:col-8","pb-0","mt-3","md:mt-0"],[1,"w-full","h-full","flex","align-items-center"],[1,"w-full"],[1,"field","grid"],["for","nombre",1,"col-fixed","custom-col-fixed-cabecera-label"],[1,"col-fixed","custom-col-fixed-cabecera-value-text"],["id","nombre"],["for","apellido1",1,"col-fixed","custom-col-fixed-cabecera-label"],["id","apellido1"],["for","apellido2",1,"col-fixed","custom-col-fixed-cabecera-label"],["id","apellido2"],["for","dniNie",1,"col-fixed","custom-col-fixed-cabecera-label"],["id","dniNie"],["for","numeroTarjeta",1,"col-fixed","custom-col-fixed-cabecera-label"],["id","numeroTarjeta"],["styleClass","titulo-situacion","showTransitionOptions","0ms",3,"value","closable"]],template:function(o,t){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),C(4,"p-image",4),a()(),r(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"label",9),p(10," Nombre "),a(),r(11,"div",10)(12,"span",11),p(13),a()()(),r(14,"div",8)(15,"label",12),p(16," 1er apellido "),a(),r(17,"div",10)(18,"span",13),p(19),a()()(),r(20,"div",8)(21,"label",14),p(22," 2do apellido "),a(),r(23,"div",10)(24,"span",15),p(25),a()()(),r(26,"div",8)(27,"label",16),p(28," DNI "),a(),r(29,"div",10)(30,"span",17),p(31),a()()(),r(32,"div",8)(33,"label",18),p(34," Numero Tarjeta "),a(),r(35,"div",10)(36,"span",19),p(37),a()()(),C(38,"p-messages",20)(39,"p-messages",20),a()()()()()),o&2&&(l(4),u("src",t.cargarFotografiaURL())("imageStyle",f(23,he))("preview",!0)("pTooltip",t.cargarFotografiaURL()==="assets/images/notImage.png"?"No hay imagen del personal":"Ver imagen del personal"),l(8),y(f(24,I)),l(),L(" ",t.datosPersonales().nombre," "),l(5),y(f(25,I)),l(),L(" ",t.datosPersonales().apellido1," "),l(5),y(f(26,I)),l(),L(" ",t.datosPersonales().apellido2," "),l(5),y(f(27,I)),l(),L(" ",t.datosPersonales().dniNie," "),l(5),y(f(28,I)),l(),L(" ",t.datosPersonales().numeroTarjeta," "),l(),u("value",t.tituloSituacionLaboralActualPMessage())("closable",!1),l(),u("value",t.bajaMedicaActualPMessage())("closable",!1))},dependencies:[k,ie,E,ne],encapsulation:2})}}return i})();var Ce=(()=>{class i{constructor(){this.http=c(Q),this.API_URL=V.API_URL}get(){let e=this.API_URL+"/datos-tics";return this.http.get(e)}getById(e){let o=this.API_URL+`/datos-tics/${e}`;return this.http.get(o)}getEmailCNB(e){return new Promise(o=>{this.getById(e).subscribe({next:t=>{o(t.emailCnb)},error:t=>{o("")}})})}edit(e,o){let t=this.API_URL+`/datos-tics/${e}`;return this.http.put(t,o)}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275prov=q({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var be=()=>({position:"sticky",top:"5rem",background:"var(--surface-ground)",zIndex:10,paddingTop:"0.5rem"}),fe=()=>({width:"2rem",height:"100%"});function Pe(i,d){i&1&&C(0,"p-progressSpinner",7),i&2&&y(f(2,fe))}function xe(i,d){if(i&1){let e=v();r(0,"div",3)(1,"p-button",4),N("onClick",function(){m(e);let t=s(2);return _(t.back())}),a(),r(2,"h3",5),p(3),a(),x(4,Pe,1,3,"p-progressSpinner",6),a()}if(i&2){let e=s(2);l(3),J(e.titulo()),l(),h(4,e.submitLoading()?4:-1)}}function ye(i,d){if(i&1){let e=v();C(0,"p-button",8)(1,"p-button",9)(2,"p-button",10)(3,"p-button",11),r(4,"p-button",12),N("onClick",function(){m(e);let t=s(2);return _(t.cargarDatos())}),a()}if(i&2){let e=s(2);u("routerLink","/personal/datos-personales/"+e.idPersona())("outlined",e.page()!==1),l(),u("routerLink","/personal/datos-laborales/"+e.idPersona())("outlined",e.page()!==2),l(),u("routerLink","/personal/situacion-laboral/"+e.idPersona())("outlined",e.page()!==3),l(),u("routerLink","/personal/plantillas/"+e.idPersona())("outlined",e.page()!==4)}}function ve(i,d){if(i&1){let e=v();r(0,"app-datos-personales",14),T("datosPersonalesChange",function(t){m(e);let n=s(3);return b(n.datosPersonales,t)||(n.datosPersonales=t),_(t)})("submitLoadingChange",function(t){m(e);let n=s(3);return b(n.submitLoading,t)||(n.submitLoading=t),_(t)}),a()}if(i&2){let e=s(3);w("datosPersonales",e.datosPersonales)("submitLoading",e.submitLoading)}}function Se(i,d){if(i&1&&x(0,ve,1,2,"app-datos-personales",13),i&2){let e=s(2);h(0,e.datosPersonales()?0:-1)}}function we(i,d){if(i&1){let e=v();r(0,"app-cabecera-datos-personales",16),T("datosPersonalesChange",function(t){m(e);let n=s(3);return b(n.datosPersonales,t)||(n.datosPersonales=t),_(t)}),a(),C(1,"hr")(2,"br")}if(i&2){let e=s(3);w("datosPersonales",e.datosPersonales),u("datosComunesIdTipo",e.datosComunes().idTipo)("bajaMedicaActual",e.bajaMedicaActual())}}function Te(i,d){if(i&1){let e=v();r(0,"app-datos-comunes",17),T("datosComunesChange",function(t){m(e);let n=s(3);return b(n.datosComunes,t)||(n.datosComunes=t),_(t)})("submitLoadingChange",function(t){m(e);let n=s(3);return b(n.submitLoading,t)||(n.submitLoading=t),_(t)}),a()}if(i&2){let e=s(3);w("datosComunes",e.datosComunes)("submitLoading",e.submitLoading),u("idPersona",e.idPersona())("mailCNB",e.mailCNB())}}function Le(i,d){if(i&1&&x(0,we,3,3)(1,Te,1,4,"app-datos-comunes",15),i&2){let e=s(2);h(0,e.datosPersonales()&&e.datosComunes()?0:-1),l(),h(1,e.datosComunes()?1:-1)}}function je(i,d){if(i&1){let e=v();r(0,"app-cabecera-datos-personales",16),T("datosPersonalesChange",function(t){m(e);let n=s(3);return b(n.datosPersonales,t)||(n.datosPersonales=t),_(t)}),a(),C(1,"hr")(2,"br")}if(i&2){let e=s(3);w("datosPersonales",e.datosPersonales),u("datosComunesIdTipo",e.datosComunes().idTipo)("bajaMedicaActual",e.bajaMedicaActual())}}function Ie(i,d){if(i&1){let e=v();r(0,"app-situacion-laboral",19),T("situacionLaboralChange",function(t){m(e);let n=s(3);return b(n.situacionLaboral,t)||(n.situacionLaboral=t),_(t)})("submitLoadingChange",function(t){m(e);let n=s(3);return b(n.submitLoading,t)||(n.submitLoading=t),_(t)}),a()}if(i&2){let e=s(3);w("situacionLaboral",e.situacionLaboral)("submitLoading",e.submitLoading)}}function Me(i,d){if(i&1&&x(0,je,3,3)(1,Ie,1,2,"app-situacion-laboral",18),i&2){let e=s(2);h(0,e.datosPersonales()&&e.datosComunes()?0:-1),l(),h(1,e.situacionLaboral()?1:-1)}}function De(i,d){if(i&1){let e=v();r(0,"app-cabecera-datos-personales",16),T("datosPersonalesChange",function(t){m(e);let n=s(3);return b(n.datosPersonales,t)||(n.datosPersonales=t),_(t)}),a(),C(1,"hr")(2,"br")}if(i&2){let e=s(3);w("datosPersonales",e.datosPersonales),u("datosComunesIdTipo",e.datosComunes().idTipo)("bajaMedicaActual",e.bajaMedicaActual())}}function Re(i,d){if(i&1&&(x(0,De,3,3),C(1,"app-plantillas")),i&2){let e=s(2);h(0,e.datosPersonales()&&e.datosComunes()?0:-1)}}function Ve(i,d){if(i&1&&(r(0,"div")(1,"p-toolbar",0),x(2,xe,5,2,"ng-template",1)(3,ye,5,8,"ng-template",2),a(),C(4,"hr"),a(),x(5,Se,1,1)(6,Le,2,2)(7,Me,2,2)(8,Re,2,1)),i&2){let e,o=s();y(f(3,be)),l(5),h(5,(e=o.page())===1?5:e===2?6:e===3?7:e===4?8:-1)}}function Ee(i,d){i&1&&(r(0,"div",20),C(1,"p-progressSpinner"),a())}var St=(()=>{class i{constructor(){this.router=c(ee),this.datosPersonalesService=c(re),this.datosComunesService=c(de),this.datosTicService=c(Ce),this.messageService=c(se),this.fechaService=c(B),this.title=c(X),this.urlState=H(this.router.events.pipe(U(e=>e instanceof $))),this.idPersona=P(()=>this.urlState()&&this.urlState().url.split("/")[3]?(sessionStorage.setItem("idPersona",this.urlState().url.split("/")[3]),this.urlState().url.split("/")[3]):this.router.url.split("/")[3]?(sessionStorage.setItem("idPersona",this.router.url.split("/")[3]),this.router.url.split("/")[3]):sessionStorage.getItem("idPersona")),this.page=P(()=>this.urlState()?this.urlState().url.includes("datos-personales")?(this.title.setTitle(`RRHH - Datos Personales (${this.idPersona()})`),1):this.urlState().url.includes("datos-laborales")?(this.title.setTitle(`RRHH - Datos Laborales (${this.idPersona()})`),2):this.urlState().url.includes("situacion-laboral")?(this.title.setTitle(`RRHH - Situaci\xF3n Laboral (${this.idPersona()})`),3):(this.title.setTitle(`RRHH - Plantillas (${this.idPersona()})`),4):this.router.url.includes("datos-personales")?(this.title.setTitle(`RRHH - Datos Personales (${this.idPersona()})`),1):this.router.url.includes("datos-laborales")?(this.title.setTitle(`RRHH - Datos Laborales (${this.idPersona()})`),2):this.router.url.includes("situacion-laboral")?(this.title.setTitle(`RRHH - Situaci\xF3n Laboral (${this.idPersona()})`),3):(this.title.setTitle(`RRHH - Plantillas (${this.idPersona()})`),4)),this.titulo=P(()=>this.page()===1?"Datos Personales":this.page()===2?"Datos Laborales":this.page()===3?"Situation Laboral":"Plantillas"),this.datosPersonales=g(null),this.datosComunes=g(null),this.situacionLaboral=g(null),this.submitLoading=g(!1),this.bajaMedicaActual=g(null),this.mailCNB=g(""),this.loading=P(()=>!!this.datosPersonales()||!!this.datosComunes()),this.hiddenTime=null,this.handleVisibilityChange=()=>{document.hidden?this.hiddenTime=Date.now():(this.hiddenTime&&Date.now()-this.hiddenTime>=6e5&&(console.log("La pesta\xF1a estuvo oculta por 10 minutos o m\xE1s"),this.cargarDatos()),this.hiddenTime=null)},j(()=>{this.cargarDatos()},{allowSignalWrites:!0}),j(()=>{console.log("Cambiaron los datos personales",this.datosPersonales()),console.log("------------------------")}),j(()=>{console.log("Cambiaron los datos comunes",this.datosComunes()),console.log("------------------------")}),j(()=>{console.log("Cambiaron la situacion laboral",this.situacionLaboral()),console.log("------------------------")}),document.addEventListener("visibilitychange",this.handleVisibilityChange)}ngOnInit(){console.warn("Modulo de Personal")}cargarDatos(){this.cargarDatosPersonales(),this.cargarDatosComunes(),this.verficarBajaMedicaPresente()}cargarDatosPersonales(){this.datosPersonales.set(null),this.datosPersonalesService.get(this.idPersona()).pipe(A(1)).subscribe({next:e=>{this.datosPersonales.set(e)},error:e=>{console.error(e),this.messageService.error(e.error.message??"Error desconocido al cargar los datos personales")}})}cargarDatosComunes(){this.datosComunes.set(null),this.datosComunesService.get(this.idPersona()).pipe(A(1)).subscribe({next:e=>{this.datosComunes.set(e),this.cargarEmailCNB()},error:e=>{console.error(e),this.messageService.error(e.error.message??"Error desconocido al cargar los datos comunes")}})}verficarBajaMedicaPresente(){this.datosPersonalesService.getBajaMedicaActual(this.idPersona()).subscribe({next:e=>{console.log("Baja m\xE9dica actual"),console.log(e),e.isBajaMedica?this.bajaMedicaActual.set(e.bajaMedica.fechaInicio):this.bajaMedicaActual.set(null)},error:e=>{console.log(e)}})}cargarEmailCNB(){this.datosTicService.getEmailCNB(this.datosComunes().id).then(e=>{this.mailCNB.set(e)})}back(){let e=sessionStorage.getItem("previousPersonalPage");e?this.router.navigateByUrl(e):this.router.navigate(["/"])}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=D({type:i,selectors:[["app-personal"]],standalone:!0,features:[R],decls:2,vars:1,consts:[["styleClass","toolbar-sin-bordes"],["pTemplate","left"],["pTemplate","right"],[1,"my-2","flex","flex-row","align-items-center"],["type","button","icon","pi pi-arrow-left","pTooltip","Volver a la b\xFAsqueda","tooltipPosition","top","styleClass","p-button-rounded mr-2",3,"onClick"],[1,"m-0"],["styleClass","ml-3","strokeWidth","6",3,"style"],["styleClass","ml-3","strokeWidth","6"],["icon","pi pi-user","label","Datos Personales","pTooltip","Ver datos personales","tooltipPosition","top","styleClass","mr-2",3,"routerLink","outlined"],["icon","pi pi-book","label","Datos Laborales","pTooltip","Ver datos personales","tooltipPosition","top","styleClass","mr-2",3,"routerLink","outlined"],["icon","pi pi-briefcase","label","Situacion Laboral","pTooltip","Ver datos personales","tooltipPosition","top","styleClass","mr-2",3,"routerLink","outlined"],["icon","pi pi-file-export","label","Plantillas","pTooltip","Ver plantillas","tooltipPosition","top","styleClass","mr-2",3,"routerLink","outlined"],["icon","pi pi-replay","pTooltip","Recargar datos","tooltipPosition","left",3,"onClick"],[3,"datosPersonales","submitLoading"],[3,"datosPersonalesChange","submitLoadingChange","datosPersonales","submitLoading"],[3,"datosComunes","submitLoading","idPersona","mailCNB"],[3,"datosPersonalesChange","datosPersonales","datosComunesIdTipo","bajaMedicaActual"],[3,"datosComunesChange","submitLoadingChange","datosComunes","submitLoading","idPersona","mailCNB"],[3,"situacionLaboral","submitLoading"],[3,"situacionLaboralChange","submitLoadingChange","situacionLaboral","submitLoading"],[1,"hold-transition","login-page","flex","justify-content-center","align-items-center",2,"height","80dvh"]],template:function(o,t){o&1&&x(0,Ve,9,4)(1,Ee,2,0),o&2&&h(0,t.loading()?0:1)},dependencies:[K,k,Y,Z,oe,te,E,ae,le,ce,ue,pe,_e]})}}return i})();export{St as PersonalComponent};
