import{a as H,b as q}from"./chunk-FZ42FID5.js";import{a as z}from"./chunk-224O6KQT.js";import{a as h}from"./chunk-DYKERIVD.js";import{a as W}from"./chunk-N25QT2AP.js";import{F as G,U as V,r as M,s as O,u as $,v as j}from"./chunk-KMAW7RSO.js";import{b as T,e as A,f as L,h as B,i as R,j as P,k as D,m as U,n as k}from"./chunk-2A4Z2JYH.js";import{z as _}from"./chunk-SR3JLMZB.js";import{D as E,q as v}from"./chunk-ZGX2TZUZ.js";import{Hb as m,Jb as w,O as f,Oa as a,Pb as N,Qb as d,U as s,Y as b,Z as x,Za as g,_a as C,gb as l,jb as c,qb as o,rb as n,sb as u,sc as F,xb as S,z as y}from"./chunk-FFU3QAVA.js";var K=(()=>{class i{constructor(){this.http=s(v),this.API_URL=h.API_URL}getAll(){let t=`${this.API_URL}/per-datos-comunes`;return this.http.get(t)}get(t){let e=`${this.API_URL}/per-datos-comunes/${t}`;return this.http.get(e)}paginated(t){let e=`${this.API_URL}/per-datos-comunes?${t}`;return this.http.get(e)}create(t){let e=`${this.API_URL}/per-datos-comunes`;return this.http.post(e,t)}edit(t,e){let r=`${this.API_URL}/per-datos-comunes/${t}`;return this.http.put(r,e)}delete(t){let e=`${this.API_URL}/per-datos-comunes/${t}`;return this.http.delete(e)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Q=(()=>{class i{constructor(){this.http=s(v),this.API_URL=h.API_URL}get(){let t=this.API_URL+"/datos-tics";return this.http.get(t)}getById(t){let e=this.API_URL+`/datos-tics/${t}`;return this.http.get(e)}getEmailCNB(t){return new Promise(e=>{this.getById(t).subscribe({next:r=>{e(r.emailCnb)},error:r=>{e("")}})})}edit(t,e){let r=this.API_URL+`/datos-tics/${t}`;return this.http.put(r,e)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=f({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var p=()=>({width:"-webkit-fill-available"}),Fe=(()=>{class i{constructor(){this.router=s(E),this.datosComunesService=s(K),this.datosTicService=s(Q),this.fechaService=s(z),this.dropdownService=s(H),this.utilService=s(q),this.messageService=s(W),this.fb=s(D),this.datosComunes=C(),this.submitLoading=C(),this.selectTrienios=F(()=>{let t=[];for(let e=0;e<14;e++)t.push({label:e.toString(),value:e});return t}),this.selectSN=g([{label:"SI",value:"SI"},{label:"NO",value:"NO"}]),this.mailCNB=g(""),this.form=this.fb.group({id:[null],fechaIngresoCnb:[null],fechaIngresoAge:[null],trienios:[null],extension:[null],visibleWeb:[null],observaciones:[null]})}ngOnInit(){this.cargarFormulario()}cargarFormulario(){this.form.reset(this.datosComunes());for(let t in this.datosComunes())if(Object.prototype.hasOwnProperty.call(this.datosComunes(),t)){let e=this.datosComunes()[t];typeof e=="string"&&e.includes("T")&&e.includes("-")&&e.includes(":")&&this.form.get(t)?.patchValue(this.fechaService.fechaAbsoluta(e))}this.cargarEmailCNB(),console.log("form cargado",this.form.value)}cargarEmailCNB(){this.datosTicService.getEmailCNB(this.datosComunes().id).then(t=>{this.mailCNB.set(t)})}save(){if(this.form.invalid){this.messageService.info("Revise los campos");return}console.log("form",this.form.value);let t=this.utilService.controlAndFormatIRIs(this.form.value);t=this.fechaService.formatDatesBeforeSend(t),console.log("bodyToSend",t),this.submitLoading.set(!0),this.datosComunesService.edit(this.datosComunes().id,t).pipe(y(1)).subscribe({next:e=>{this.messageService.success("Datos laborales guardados"),this.datosComunes.set(e),this.ngOnInit(),this.submitLoading.set(!1)},error:e=>{console.error(e),this.messageService.error(e.error.message??"Error desconocido al actualizar los datos laborales"),this.submitLoading.set(!1)}})}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=x({type:i,selectors:[["app-datos-comunes"]],inputs:{datosComunes:[b.SignalBased,"datosComunes"],submitLoading:[b.SignalBased,"submitLoading"]},outputs:{datosComunes:"datosComunesChange",submitLoading:"submitLoadingChange"},standalone:!0,features:[N],decls:41,vars:33,consts:[["autocomplete","off",3,"ngSubmit","keyup.control.enter","formGroup"],[1,"grid"],[1,"col-12","field","grid","pt-0","mb-0"],["for","fechaIngresoCnb",1,"col-fixed","custom-col-fixed-label"],[1,"col-fixed","custom-col-fixed-input"],["dateFormat","dd/mm/yy","formControlName","fechaIngresoCnb",3,"showIcon","showClear","showOnFocus"],["for","fechaIngresoAge",1,"col-fixed","custom-col-fixed-label"],["dateFormat","dd/mm/yy","formControlName","fechaIngresoAge",3,"showIcon","showClear","showOnFocus"],[1,"col-12","field","grid","pt-1","mb-0"],["for","trienios",1,"col-fixed","custom-col-fixed-label"],[1,"col-fixed","custom-col-fixed-input-sm"],["formControlName","trienios","placeholder","Seleccionar",3,"options","showClear"],["for","extension",1,"col-fixed","custom-col-fixed-label"],["pInputText","","id","extension","formControlName","extension","aria-describedby","extension-help","placeholder","Provincia","autocomplete","off"],["for","extension",1,"col-fixed","custom-col-fixed-label",3,"pTooltip"],[1,"col-fixed","custom-col-fixed-input",3,"pTooltip"],["for","visibleWeb",1,"col-fixed","custom-col-fixed-label"],["formControlName","visibleWeb","placeholder","Seleccionar",3,"options","showClear"],["for","observaciones",1,"col-fixed","custom-col-fixed-label","align-items-start"],[1,"col-fixed","custom-col-fixed-input-bg"],["pInputTextarea","","id","observaciones","formControlName","observaciones","aria-describedby","observaciones-help","placeholder","Observaciones","autocomplete","off","rows","3",3,"autoResize"],[1,"col-12","transparent-background",2,"position","sticky","bottom","0"],[1,"w-full","flex","justify-content-center"],["styleClass","p-button-lg p-button-rounded","icon","pi pi-save","label","Guardar","pTooltip","Guardar cambios",3,"onClick"]],template:function(e,r){e&1&&(o(0,"form",0),S("ngSubmit",function(){return r.save()})("keyup.control.enter",function(){return r.save()}),o(1,"div",1)(2,"div",2)(3,"label",3),m(4," Fecha de ingreso en el CNB "),n(),o(5,"div",4),u(6,"p-calendar",5),n()(),o(7,"div",2)(8,"label",6),m(9," Fecha de ingreso en el AGE "),n(),o(10,"div",4),u(11,"p-calendar",7),n()(),o(12,"div",8)(13,"label",9),m(14," Trienios "),n(),o(15,"div",10),u(16,"p-dropdown",11),n()(),o(17,"div",2)(18,"label",12),m(19," Extension "),n(),o(20,"div",4),u(21,"input",13),n()(),o(22,"div",2)(23,"label",14),m(24," Email del CNB "),n(),o(25,"div",15)(26,"b"),m(27),n()()(),o(28,"div",8)(29,"label",16),m(30," Visible en Web CNB "),n(),o(31,"div",10),u(32,"p-dropdown",17),n()(),o(33,"div",2)(34,"label",18),m(35," Observaciones "),n(),o(36,"div",19),u(37,"textarea",20),n()(),o(38,"div",21)(39,"div",22)(40,"p-button",23),S("onClick",function(){return r.save()}),n()()()()()),e&2&&(l("formGroup",r.form),a(6),c(d(27,p)),l("showIcon",!0)("showClear",!0)("showOnFocus",!1),a(5),c(d(28,p)),l("showIcon",!0)("showClear",!0)("showOnFocus",!1),a(5),c(d(29,p)),l("options",r.selectTrienios())("showClear",!0),a(5),c(d(30,p)),a(2),l("pTooltip",r.mailCNB()?"":"No hay email registrado"),a(2),l("pTooltip",r.mailCNB()?"":"No hay email registrado"),a(2),w(" ",r.mailCNB()," "),a(5),c(d(31,p)),l("options",r.selectSN())("showClear",!0),a(5),c(d(32,p)),l("autoResize",!0))},dependencies:[V,_,B,T,A,L,R,P,j,G,$,M,O,k,U]})}}return i})();export{K as a,Fe as b};
