import{a as q,b as J}from"./chunk-XEDJVIF6.js";import{a as H}from"./chunk-AWRCIJRC.js";import{a as N}from"./chunk-DYKERIVD.js";import{a as z}from"./chunk-FKGF6V4I.js";import{F as V,V as W,r as $,s as U,u as G,v as j}from"./chunk-VCJMVCMV.js";import{b as L,e as A,f as B,h as P,i as D,j as R,k,m as M,n as O}from"./chunk-UVXM5JHS.js";import{z as T}from"./chunk-D74LBUZY.js";import{D as E,q as _}from"./chunk-UFTRMQMS.js";import{Hb as m,Jb as I,O as S,Oa as r,Pb as F,Qb as u,U as a,Y as f,Z as y,Za as x,_a as b,gb as l,jb as c,qa as h,qb as o,rb as i,sb as d,tc as w,xb as v,z as C}from"./chunk-ALXFD6NA.js";var K=(()=>{class s{constructor(){this.http=a(_),this.API_URL=N.API_URL}getAll(){let t=`${this.API_URL}/per-datos-comunes`;return this.http.get(t)}get(t){let e=`${this.API_URL}/per-datos-comunes/${t}`;return this.http.get(e)}paginated(t){let e=`${this.API_URL}/per-datos-comunes?${t}`;return this.http.get(e)}create(t){let e=`${this.API_URL}/per-datos-comunes`;return this.http.post(e,t)}edit(t,e){let n=`${this.API_URL}/per-datos-comunes/${t}`;return this.http.put(n,e)}delete(t){let e=`${this.API_URL}/per-datos-comunes/${t}`;return this.http.delete(e)}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275prov=S({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var p=()=>({width:"-webkit-fill-available"}),Se=(()=>{class s{constructor(){this.router=a(E),this.datosComunesService=a(K),this.fechaService=a(H),this.dropdownService=a(q),this.utilService=a(J),this.messageService=a(z),this.fb=a(k),this.datosComunes=b(),this.submitLoading=b(),this.idPersona=h(),this.mailCNB=h(),this.selectTrienios=w(()=>{let t=[];for(let e=0;e<14;e++)t.push({label:e.toString(),value:e});return t}),this.selectSN=x([{label:"SI",value:"SI"},{label:"NO",value:"NO"}]),this.form=this.fb.group({id:[null],fechaIngresoCnb:[null],fechaIngresoAge:[null],trienios:[null],extension:[null],visibleWeb:[null],observaciones:[null]})}ngOnInit(){this.cargarFormulario()}cargarFormulario(){this.form.reset(this.datosComunes());for(let t in this.datosComunes())if(Object.prototype.hasOwnProperty.call(this.datosComunes(),t)){let e=this.datosComunes()[t];typeof e=="string"&&e.includes("T")&&e.includes("-")&&e.includes(":")&&this.form.get(t)?.patchValue(this.fechaService.fechaAbsoluta(e))}console.log("form cargado",this.form.value)}save(){if(this.form.invalid){this.messageService.info("Revise los campos");return}console.log("form",this.form.value);let t=this.utilService.controlAndFormatIRIs(this.form.value);t=this.fechaService.formatDatesBeforeSend(t),console.log("bodyToSend",t),this.submitLoading.set(!0),this.datosComunesService.edit(this.idPersona(),t).pipe(C(1)).subscribe({next:e=>{this.messageService.success("Datos laborales guardados"),this.datosComunes.set(e),this.ngOnInit(),this.submitLoading.set(!1)},error:e=>{console.error(e),this.messageService.error(e.error.message||e.message||"Error desconocido al actualizar los datos laborales"),this.submitLoading.set(!1)}})}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275cmp=y({type:s,selectors:[["app-datos-comunes"]],inputs:{datosComunes:[f.SignalBased,"datosComunes"],submitLoading:[f.SignalBased,"submitLoading"],idPersona:[f.SignalBased,"idPersona"],mailCNB:[f.SignalBased,"mailCNB"]},outputs:{datosComunes:"datosComunesChange",submitLoading:"submitLoadingChange"},standalone:!0,features:[F],decls:41,vars:35,consts:[["autocomplete","off",3,"ngSubmit","keyup.control.enter","formGroup"],[1,"grid"],[1,"col-12","field","grid","pt-0","mb-0"],["for","fechaIngresoCnb",1,"col-fixed","custom-col-fixed-label"],[1,"col-fixed","custom-col-fixed-input"],["dateFormat","dd/mm/yy","formControlName","fechaIngresoCnb",3,"showIcon","showClear","showOnFocus"],["for","fechaIngresoAge",1,"col-fixed","custom-col-fixed-label"],["dateFormat","dd/mm/yy","formControlName","fechaIngresoAge",3,"showIcon","showClear","showOnFocus"],["for","trienios",1,"col-fixed","custom-col-fixed-label"],[1,"col-fixed","custom-col-fixed-input-sm"],["formControlName","trienios","placeholder","Seleccionar",3,"options","showClear"],["for","extension",1,"col-fixed","custom-col-fixed-label"],["pInputText","","id","extension","formControlName","extension","aria-describedby","extension-help","placeholder","Provincia","autocomplete","off"],["for","extension",1,"col-fixed","custom-col-fixed-label",3,"pTooltip"],[1,"col-fixed","custom-col-fixed-input",3,"pTooltip"],["for","visibleWeb",1,"col-fixed","custom-col-fixed-label"],["formControlName","visibleWeb","placeholder","Seleccionar",3,"options","showClear"],["for","observaciones",1,"col-fixed","custom-col-fixed-label","align-items-start"],[1,"col-fixed","custom-col-fixed-input-bg"],["pInputTextarea","","id","observaciones","formControlName","observaciones","aria-describedby","observaciones-help","placeholder","Observaciones","autocomplete","off","rows","3",3,"autoResize"],[1,"col-12","transparent-background",2,"position","sticky","bottom","0"],[1,"w-full","flex","justify-content-center"],["styleClass","p-button-lg p-button-rounded","icon","pi pi-save","label","Guardar",3,"onClick","pTooltip","disabled"]],template:function(e,n){e&1&&(o(0,"form",0),v("ngSubmit",function(){return n.save()})("keyup.control.enter",function(){return n.save()}),o(1,"div",1)(2,"div",2)(3,"label",3),m(4," Fecha de ingreso en el CNB "),i(),o(5,"div",4),d(6,"p-calendar",5),i()(),o(7,"div",2)(8,"label",6),m(9," Fecha de ingreso en el AGE "),i(),o(10,"div",4),d(11,"p-calendar",7),i()(),o(12,"div",2)(13,"label",8),m(14," Trienios "),i(),o(15,"div",9),d(16,"p-dropdown",10),i()(),o(17,"div",2)(18,"label",11),m(19," Extension "),i(),o(20,"div",4),d(21,"input",12),i()(),o(22,"div",2)(23,"label",13),m(24," Email del CNB "),i(),o(25,"div",14)(26,"b"),m(27),i()()(),o(28,"div",2)(29,"label",15),m(30," Visible en Web CNB "),i(),o(31,"div",9),d(32,"p-dropdown",16),i()(),o(33,"div",2)(34,"label",17),m(35," Observaciones "),i(),o(36,"div",18),d(37,"textarea",19),i()(),o(38,"div",20)(39,"div",21)(40,"p-button",22),v("onClick",function(){return n.save()}),i()()()()()),e&2&&(l("formGroup",n.form),r(6),c(u(29,p)),l("showIcon",!0)("showClear",!0)("showOnFocus",!1),r(5),c(u(30,p)),l("showIcon",!0)("showClear",!0)("showOnFocus",!1),r(5),c(u(31,p)),l("options",n.selectTrienios())("showClear",!0),r(5),c(u(32,p)),r(2),l("pTooltip",n.mailCNB()?"":"No hay email registrado"),r(2),l("pTooltip",n.mailCNB()?"":"No hay email registrado"),r(2),I(" ",n.mailCNB()," "),r(5),c(u(33,p)),l("options",n.selectSN())("showClear",!0),r(5),c(u(34,p)),l("autoResize",!0),r(3),l("pTooltip",n.submitLoading()?"Guardando...":"Guardar")("disabled",n.submitLoading()))},dependencies:[W,T,P,L,A,B,D,R,j,V,G,$,U,O,M]})}}return s})();export{K as a,Se as b};
